"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/auth/login";
exports.ids = ["pages/api/auth/login"];
exports.modules = {

/***/ "firebase-admin":
/*!*********************************!*\
  !*** external "firebase-admin" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("firebase-admin");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Flogin&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cauth%5Clogin.ts&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Flogin&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cauth%5Clogin.ts&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_auth_login_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\auth\\login.ts */ \"(api)/./pages/api/auth/login.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_auth_login_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_auth_login_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/auth/login\",\n        pathname: \"/api/auth/login\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_auth_login_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmF1dGglMkZsb2dpbiZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDYXV0aCU1Q2xvZ2luLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ3lEO0FBQ3pEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxxREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMscURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWFzdGVyc3RyZWFtLWxlYXJuaW5nLXBsYXRmb3JtLz9iMGI4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcYXV0aFxcXFxsb2dpbi50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2F1dGgvbG9naW5cIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hdXRoL2xvZ2luXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Flogin&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cauth%5Clogin.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/auth/login.ts":
/*!*********************************!*\
  !*** ./pages/api/auth/login.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var firebase_admin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase-admin */ \"firebase-admin\");\n/* harmony import */ var firebase_admin__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(firebase_admin__WEBPACK_IMPORTED_MODULE_0__);\n\n// Initialize Firebase Admin\nconst initFirebaseAdmin = ()=>{\n    if (!(firebase_admin__WEBPACK_IMPORTED_MODULE_0___default().apps).length) {\n        const serviceAccountKey = process.env.FIREBASE_SERVICE_ACCOUNT_KEY;\n        if (!serviceAccountKey) {\n            throw new Error(\"FIREBASE_SERVICE_ACCOUNT_KEY is not configured\");\n        }\n        let serviceAccount;\n        try {\n            serviceAccount = JSON.parse(serviceAccountKey);\n        } catch (err) {\n            serviceAccount = serviceAccountKey;\n        }\n        firebase_admin__WEBPACK_IMPORTED_MODULE_0___default().initializeApp({\n            credential: firebase_admin__WEBPACK_IMPORTED_MODULE_0___default().credential.cert(serviceAccount)\n        });\n    }\n};\n// Verify password using Firebase REST API\nconst verifyPasswordWithFirebase = async (email, password, apiKey)=>{\n    const url = `https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=${apiKey}`;\n    const response = await fetch(url, {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n            email,\n            password,\n            returnSecureToken: true\n        })\n    });\n    if (!response.ok) {\n        const error = await response.json();\n        if (error.error?.message === \"INVALID_PASSWORD\") {\n            throw new Error(\"INVALID_PASSWORD\");\n        }\n        if (error.error?.message === \"EMAIL_NOT_FOUND\") {\n            throw new Error(\"EMAIL_NOT_FOUND\");\n        }\n        throw new Error(error.error?.message || \"Password verification failed\");\n    }\n    return response.json();\n};\n// JWT utilities\nclass JWTManager {\n    static{\n        this.JWT_SECRET = process.env.JWT_SECRET || \"dev-secret-key-change-in-production\";\n    }\n    static{\n        this.JWT_EXPIRES_IN = Number(process.env.JWT_EXPIRES_IN) || 3600 // 1 hour\n        ;\n    }\n    static base64UrlEncode(str) {\n        return Buffer.from(str).toString(\"base64\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=/g, \"\");\n    }\n    static generateSignature(message) {\n        const crypto = __webpack_require__(/*! crypto */ \"crypto\");\n        return crypto.createHmac(\"sha256\", this.JWT_SECRET).update(message).digest(\"base64\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=/g, \"\");\n    }\n    static createToken(payload) {\n        const header = {\n            alg: \"HS256\",\n            typ: \"JWT\"\n        };\n        const iat = Math.floor(Date.now() / 1000);\n        const exp = iat + this.JWT_EXPIRES_IN;\n        const tokenPayload = {\n            ...payload,\n            iat,\n            exp\n        };\n        const headerEncoded = this.base64UrlEncode(JSON.stringify(header));\n        const payloadEncoded = this.base64UrlEncode(JSON.stringify(tokenPayload));\n        const message = `${headerEncoded}.${payloadEncoded}`;\n        const signature = this.generateSignature(message);\n        return `${message}.${signature}`;\n    }\n    static getTokenExpiry() {\n        return this.JWT_EXPIRES_IN * 1000; // in milliseconds\n    }\n}\n// Validation utilities\nconst validation = {\n    validateEmail: (email)=>{\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        return emailRegex.test(email);\n    },\n    validatePassword: (password)=>{\n        return Boolean(password && password.length >= 6);\n    },\n    validateCredentials: (email, password)=>{\n        if (!email || !password) {\n            throw new Error(\"MISSING_CREDENTIALS\");\n        }\n        if (!validation.validateEmail(email)) {\n            throw new Error(\"INVALID_EMAIL\");\n        }\n        if (!validation.validatePassword(password)) {\n            throw new Error(\"WEAK_PASSWORD\");\n        }\n    }\n};\n// Rate limiting\nconst loginAttempts = new Map();\nconst MAX_ATTEMPTS = 5;\nconst LOCKOUT_DURATION = 15 * 60 * 1000; // 15 minutes\nconst rateLimit = {\n    checkRateLimit: (email)=>{\n        const now = Date.now();\n        const attempts = loginAttempts.get(email);\n        if (attempts && now - attempts.lastAttempt < LOCKOUT_DURATION) {\n            if (attempts.count >= MAX_ATTEMPTS) {\n                throw new Error(\"RATE_LIMITED\");\n            }\n        } else if (attempts) {\n            loginAttempts.delete(email);\n        }\n    },\n    recordAttempt: (email, success)=>{\n        const now = Date.now();\n        if (success) {\n            loginAttempts.delete(email);\n        } else {\n            const attempts = loginAttempts.get(email) || {\n                count: 0,\n                lastAttempt: 0\n            };\n            attempts.count += 1;\n            attempts.lastAttempt = now;\n            loginAttempts.set(email, attempts);\n        }\n    }\n};\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        initFirebaseAdmin();\n        const { email, password } = req.body;\n        const apiKey = process.env.FIREBASE_API_KEY;\n        if (!apiKey) {\n            throw new Error(\"FIREBASE_API_KEY is not configured\");\n        }\n        // Validate input\n        validation.validateCredentials(email, password);\n        // Check rate limiting\n        rateLimit.checkRateLimit(email);\n        console.log(\"\\uD83D\\uDD10 Login attempt for:\", email);\n        // Verify password using Firebase REST API\n        let authResponse;\n        try {\n            authResponse = await verifyPasswordWithFirebase(email, password, apiKey);\n        } catch (error) {\n            rateLimit.recordAttempt(email, false);\n            if (error.message === \"INVALID_PASSWORD\" || error.message === \"EMAIL_NOT_FOUND\") {\n                return res.status(401).json({\n                    error: \"Invalid email or password\"\n                });\n            }\n            throw error;\n        }\n        // Get user record from Firebase Auth\n        let userRecord;\n        try {\n            userRecord = await firebase_admin__WEBPACK_IMPORTED_MODULE_0___default().auth().getUserByEmail(email);\n        } catch (error) {\n            rateLimit.recordAttempt(email, false);\n            if (error.code === \"auth/user-not-found\") {\n                return res.status(401).json({\n                    error: \"Invalid email or password\"\n                });\n            }\n            throw error;\n        }\n        // Get user's role and permissions from Firestore\n        let userRole = \"user\";\n        let userPermissions = [];\n        let userData = {};\n        try {\n            const db = firebase_admin__WEBPACK_IMPORTED_MODULE_0___default().firestore();\n            const userDoc = await db.collection(\"users\").doc(userRecord.uid).get();\n            console.log(\"\\uD83D\\uDD0D Firestore user lookup:\", {\n                uid: userRecord.uid,\n                exists: userDoc.exists,\n                data: userDoc.data()\n            });\n            if (userDoc.exists) {\n                const data = userDoc.data();\n                userRole = data?.role || \"user\";\n                console.log(\"\\uD83D\\uDCCB User document found:\", {\n                    role: userRole,\n                    userData: data\n                });\n                userPermissions = data?.permissions || [];\n                userData = data || {};\n            }\n        } catch (error) {\n            console.warn(\"Could not fetch user role from Firestore:\", error);\n        }\n        // Create JWT token with user information and role\n        const tokenPayload = {\n            userId: userRecord.uid,\n            email: userRecord.email,\n            displayName: userRecord.displayName || \"\",\n            photoURL: userRecord.photoURL || null,\n            role: userRole,\n            permissions: userPermissions\n        };\n        const jwtToken = JWTManager.createToken(tokenPayload);\n        const tokenExpiryMs = JWTManager.getTokenExpiry();\n        // Prepare user data for response\n        const responseUser = {\n            id: userRecord.uid,\n            email: userRecord.email,\n            full_name: userRecord.displayName || \"\",\n            displayName: userRecord.displayName || \"\",\n            photoURL: userRecord.photoURL || null,\n            role: userRole,\n            permissions: userPermissions,\n            ...userData\n        };\n        // Set JWT token in cookie (accessible to JavaScript)\n        // Critical: DO NOT set Domain attribute - let browser use current domain only\n        // This ensures document.cookie can access the token\n        const maxAge = Math.floor(tokenExpiryMs / 1000); // Convert ms to seconds\n        const isProduction =  false || req.headers.host?.includes(\"fly.dev\") || req.headers[\"x-forwarded-proto\"] === \"https\";\n        const cookieString = [\n            `app_user=${jwtToken}`,\n            \"Path=/\",\n            // When in production OR inside Builder.io iframe â†’ must use None; Secure\n            isProduction ? \"SameSite=None\" : \"SameSite=Lax\",\n            isProduction ? \"Secure\" : \"\",\n            `Max-Age=${maxAge}`\n        ].filter(Boolean).join(\"; \");\n        console.log(`ðŸ” Login: Setting app_user cookie (max-age: ${maxAge}s, secure: ${isProduction})`);\n        res.setHeader(\"Set-Cookie\", cookieString);\n        rateLimit.recordAttempt(email, true);\n        console.log(\"âœ… Login successful for:\", email);\n        return res.status(200).json({\n            message: \"Login successful\",\n            user: responseUser,\n            token: jwtToken // Also return token for client-side storage if needed\n        });\n    } catch (error) {\n        console.error(\"âŒ Login error:\", error?.message || error);\n        const errorMessages = {\n            \"MISSING_CREDENTIALS\": {\n                status: 400,\n                message: \"Email and password are required\"\n            },\n            \"INVALID_EMAIL\": {\n                status: 400,\n                message: \"Please enter a valid email address\"\n            },\n            \"WEAK_PASSWORD\": {\n                status: 400,\n                message: \"Password must be at least 6 characters\"\n            },\n            \"RATE_LIMITED\": {\n                status: 429,\n                message: \"Too many login attempts. Please try again later.\"\n            },\n            \"FIREBASE_API_KEY is not configured\": {\n                status: 500,\n                message: \"Server configuration error - FIREBASE_API_KEY missing\"\n            }\n        };\n        const errorInfo = errorMessages[error?.message];\n        if (errorInfo) {\n            console.error(\"Mapped error response:\", errorInfo);\n            return res.status(errorInfo.status).json({\n                error: errorInfo.message\n            });\n        }\n        // Log full error for debugging\n        console.error(\"Unmapped error:\", error?.message, error?.toString());\n        return res.status(500).json({\n            error: \"Login failed. Please try again.\",\n            debug:  true ? error?.message : 0\n        });\n    }\n}\nconst config = {\n    api: {\n        bodyParser: {\n            sizeLimit: \"1mb\"\n        }\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU87WUFDUHNHLE9BQU85SCxLQUF5QixHQUFnQndCLE9BQU9FLFVBQVVxRyxDQUFTQTtRQUM1RTtJQUNGO0FBQ0Y7QUFFTyxNQUFNQyxTQUFTO0lBQ3BCQyxLQUFLO1FBQUVDLFlBQVk7WUFBRUMsV0FBVztRQUFNO0lBQUU7QUFDMUMsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL21hc3RlcnN0cmVhbS1sZWFybmluZy1wbGF0Zm9ybS8uL3BhZ2VzL2FwaS9hdXRoL2xvZ2luLnRzPzc0NGQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xyXG5pbXBvcnQgYWRtaW4gZnJvbSAnZmlyZWJhc2UtYWRtaW4nO1xyXG5cclxuLy8gSW5pdGlhbGl6ZSBGaXJlYmFzZSBBZG1pblxyXG5jb25zdCBpbml0RmlyZWJhc2VBZG1pbiA9ICgpID0+IHtcclxuICBpZiAoIWFkbWluLmFwcHMubGVuZ3RoKSB7XHJcbiAgICBjb25zdCBzZXJ2aWNlQWNjb3VudEtleSA9IHByb2Nlc3MuZW52LkZJUkVCQVNFX1NFUlZJQ0VfQUNDT1VOVF9LRVk7XHJcbiAgICBpZiAoIXNlcnZpY2VBY2NvdW50S2V5KSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignRklSRUJBU0VfU0VSVklDRV9BQ0NPVU5UX0tFWSBpcyBub3QgY29uZmlndXJlZCcpO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBzZXJ2aWNlQWNjb3VudDtcclxuICAgIHRyeSB7XHJcbiAgICAgIHNlcnZpY2VBY2NvdW50ID0gSlNPTi5wYXJzZShzZXJ2aWNlQWNjb3VudEtleSk7XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgc2VydmljZUFjY291bnQgPSBzZXJ2aWNlQWNjb3VudEtleTtcclxuICAgIH1cclxuXHJcbiAgICBhZG1pbi5pbml0aWFsaXplQXBwKHtcclxuICAgICAgY3JlZGVudGlhbDogYWRtaW4uY3JlZGVudGlhbC5jZXJ0KHNlcnZpY2VBY2NvdW50KSxcclxuICAgIH0pO1xyXG4gIH1cclxufTtcclxuXHJcbi8vIFZlcmlmeSBwYXNzd29yZCB1c2luZyBGaXJlYmFzZSBSRVNUIEFQSVxyXG5jb25zdCB2ZXJpZnlQYXNzd29yZFdpdGhGaXJlYmFzZSA9IGFzeW5jIChlbWFpbDogc3RyaW5nLCBwYXNzd29yZDogc3RyaW5nLCBhcGlLZXk6IHN0cmluZyk6IFByb21pc2U8YW55PiA9PiB7XHJcbiAgY29uc3QgdXJsID0gYGh0dHBzOi8vaWRlbnRpdHl0b29sa2l0Lmdvb2dsZWFwaXMuY29tL3YxL2FjY291bnRzOnNpZ25JbldpdGhQYXNzd29yZD9rZXk9JHthcGlLZXl9YDtcclxuXHJcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcclxuICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgIGVtYWlsLFxyXG4gICAgICBwYXNzd29yZCxcclxuICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWVcclxuICAgIH0pXHJcbiAgfSk7XHJcblxyXG4gIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgIGNvbnN0IGVycm9yID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgaWYgKGVycm9yLmVycm9yPy5tZXNzYWdlID09PSAnSU5WQUxJRF9QQVNTV09SRCcpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJTlZBTElEX1BBU1NXT1JEJyk7XHJcbiAgICB9XHJcbiAgICBpZiAoZXJyb3IuZXJyb3I/Lm1lc3NhZ2UgPT09ICdFTUFJTF9OT1RfRk9VTkQnKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignRU1BSUxfTk9UX0ZPVU5EJyk7XHJcbiAgICB9XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IuZXJyb3I/Lm1lc3NhZ2UgfHwgJ1Bhc3N3b3JkIHZlcmlmaWNhdGlvbiBmYWlsZWQnKTtcclxuICB9XHJcblxyXG4gIHJldHVybiByZXNwb25zZS5qc29uKCk7XHJcbn07XHJcblxyXG4vLyBKV1QgdXRpbGl0aWVzXHJcbmNsYXNzIEpXVE1hbmFnZXIge1xyXG4gIHByaXZhdGUgc3RhdGljIEpXVF9TRUNSRVQgPSBwcm9jZXNzLmVudi5KV1RfU0VDUkVUIHx8ICdkZXYtc2VjcmV0LWtleS1jaGFuZ2UtaW4tcHJvZHVjdGlvbic7XHJcbiAgcHJpdmF0ZSBzdGF0aWMgSldUX0VYUElSRVNfSU4gPSBOdW1iZXIocHJvY2Vzcy5lbnYuSldUX0VYUElSRVNfSU4pIHx8IDM2MDA7IC8vIDEgaG91clxyXG5cclxuICBzdGF0aWMgYmFzZTY0VXJsRW5jb2RlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIHJldHVybiBCdWZmZXIuZnJvbShzdHIpXHJcbiAgICAgIC50b1N0cmluZygnYmFzZTY0JylcclxuICAgICAgLnJlcGxhY2UoL1xcKy9nLCAnLScpXHJcbiAgICAgIC5yZXBsYWNlKC9cXC8vZywgJ18nKVxyXG4gICAgICAucmVwbGFjZSgvPS9nLCAnJyk7XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgZ2VuZXJhdGVTaWduYXR1cmUobWVzc2FnZTogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGNyeXB0byA9IHJlcXVpcmUoJ2NyeXB0bycpO1xyXG4gICAgcmV0dXJuIGNyeXB0b1xyXG4gICAgICAuY3JlYXRlSG1hYygnc2hhMjU2JywgdGhpcy5KV1RfU0VDUkVUKVxyXG4gICAgICAudXBkYXRlKG1lc3NhZ2UpXHJcbiAgICAgIC5kaWdlc3QoJ2Jhc2U2NCcpXHJcbiAgICAgIC5yZXBsYWNlKC9cXCsvZywgJy0nKVxyXG4gICAgICAucmVwbGFjZSgvXFwvL2csICdfJylcclxuICAgICAgLnJlcGxhY2UoLz0vZywgJycpO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIGNyZWF0ZVRva2VuKHBheWxvYWQ6IGFueSk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBoZWFkZXIgPSB7IGFsZzogJ0hTMjU2JywgdHlwOiAnSldUJyB9O1xyXG4gICAgY29uc3QgaWF0ID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCk7XHJcbiAgICBjb25zdCBleHAgPSBpYXQgKyB0aGlzLkpXVF9FWFBJUkVTX0lOO1xyXG5cclxuICAgIGNvbnN0IHRva2VuUGF5bG9hZCA9IHsgLi4ucGF5bG9hZCwgaWF0LCBleHAgfTtcclxuXHJcbiAgICBjb25zdCBoZWFkZXJFbmNvZGVkID0gdGhpcy5iYXNlNjRVcmxFbmNvZGUoSlNPTi5zdHJpbmdpZnkoaGVhZGVyKSk7XHJcbiAgICBjb25zdCBwYXlsb2FkRW5jb2RlZCA9IHRoaXMuYmFzZTY0VXJsRW5jb2RlKEpTT04uc3RyaW5naWZ5KHRva2VuUGF5bG9hZCkpO1xyXG4gICAgY29uc3QgbWVzc2FnZSA9IGAke2hlYWRlckVuY29kZWR9LiR7cGF5bG9hZEVuY29kZWR9YDtcclxuICAgIGNvbnN0IHNpZ25hdHVyZSA9IHRoaXMuZ2VuZXJhdGVTaWduYXR1cmUobWVzc2FnZSk7XHJcblxyXG4gICAgcmV0dXJuIGAke21lc3NhZ2V9LiR7c2lnbmF0dXJlfWA7XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgZ2V0VG9rZW5FeHBpcnkoKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLkpXVF9FWFBJUkVTX0lOICogMTAwMDsgLy8gaW4gbWlsbGlzZWNvbmRzXHJcbiAgfVxyXG59XHJcblxyXG4vLyBWYWxpZGF0aW9uIHV0aWxpdGllc1xyXG5jb25zdCB2YWxpZGF0aW9uID0ge1xyXG4gIHZhbGlkYXRlRW1haWw6IChlbWFpbDogc3RyaW5nKTogYm9vbGVhbiA9PiB7XHJcbiAgICBjb25zdCBlbWFpbFJlZ2V4ID0gL15bXlxcc0BdK0BbXlxcc0BdK1xcLlteXFxzQF0rJC87XHJcbiAgICByZXR1cm4gZW1haWxSZWdleC50ZXN0KGVtYWlsKTtcclxuICB9LFxyXG5cclxuICB2YWxpZGF0ZVBhc3N3b3JkOiAocGFzc3dvcmQ6IHN0cmluZyk6IGJvb2xlYW4gPT4ge1xyXG4gICAgcmV0dXJuIEJvb2xlYW4ocGFzc3dvcmQgJiYgcGFzc3dvcmQubGVuZ3RoID49IDYpO1xyXG4gIH0sXHJcblxyXG4gIHZhbGlkYXRlQ3JlZGVudGlhbHM6IChlbWFpbDogc3RyaW5nLCBwYXNzd29yZDogc3RyaW5nKTogdm9pZCA9PiB7XHJcbiAgICBpZiAoIWVtYWlsIHx8ICFwYXNzd29yZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01JU1NJTkdfQ1JFREVOVElBTFMnKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIXZhbGlkYXRpb24udmFsaWRhdGVFbWFpbChlbWFpbCkpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJTlZBTElEX0VNQUlMJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkYXRlUGFzc3dvcmQocGFzc3dvcmQpKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignV0VBS19QQVNTV09SRCcpO1xyXG4gICAgfVxyXG4gIH1cclxufTtcclxuXHJcbi8vIFJhdGUgbGltaXRpbmdcclxuY29uc3QgbG9naW5BdHRlbXB0cyA9IG5ldyBNYXA8c3RyaW5nLCB7IGNvdW50OiBudW1iZXI7IGxhc3RBdHRlbXB0OiBudW1iZXIgfT4oKTtcclxuY29uc3QgTUFYX0FUVEVNUFRTID0gNTtcclxuY29uc3QgTE9DS09VVF9EVVJBVElPTiA9IDE1ICogNjAgKiAxMDAwOyAvLyAxNSBtaW51dGVzXHJcblxyXG5jb25zdCByYXRlTGltaXQgPSB7XHJcbiAgY2hlY2tSYXRlTGltaXQ6IChlbWFpbDogc3RyaW5nKTogdm9pZCA9PiB7XHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgY29uc3QgYXR0ZW1wdHMgPSBsb2dpbkF0dGVtcHRzLmdldChlbWFpbCk7XHJcblxyXG4gICAgaWYgKGF0dGVtcHRzICYmIG5vdyAtIGF0dGVtcHRzLmxhc3RBdHRlbXB0IDwgTE9DS09VVF9EVVJBVElPTikge1xyXG4gICAgICBpZiAoYXR0ZW1wdHMuY291bnQgPj0gTUFYX0FUVEVNUFRTKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSQVRFX0xJTUlURUQnKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIGlmIChhdHRlbXB0cykge1xyXG4gICAgICBsb2dpbkF0dGVtcHRzLmRlbGV0ZShlbWFpbCk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgcmVjb3JkQXR0ZW1wdDogKGVtYWlsOiBzdHJpbmcsIHN1Y2Nlc3M6IGJvb2xlYW4pOiB2b2lkID0+IHtcclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcblxyXG4gICAgaWYgKHN1Y2Nlc3MpIHtcclxuICAgICAgbG9naW5BdHRlbXB0cy5kZWxldGUoZW1haWwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgYXR0ZW1wdHMgPSBsb2dpbkF0dGVtcHRzLmdldChlbWFpbCkgfHwgeyBjb3VudDogMCwgbGFzdEF0dGVtcHQ6IDAgfTtcclxuICAgICAgYXR0ZW1wdHMuY291bnQgKz0gMTtcclxuICAgICAgYXR0ZW1wdHMubGFzdEF0dGVtcHQgPSBub3c7XHJcbiAgICAgIGxvZ2luQXR0ZW1wdHMuc2V0KGVtYWlsLCBhdHRlbXB0cyk7XHJcbiAgICB9XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xyXG4gIGlmIChyZXEubWV0aG9kICE9PSAnUE9TVCcpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICBpbml0RmlyZWJhc2VBZG1pbigpO1xyXG5cclxuICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSByZXEuYm9keTtcclxuICAgIGNvbnN0IGFwaUtleSA9IHByb2Nlc3MuZW52LkZJUkVCQVNFX0FQSV9LRVk7XHJcblxyXG4gICAgaWYgKCFhcGlLZXkpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGSVJFQkFTRV9BUElfS0VZIGlzIG5vdCBjb25maWd1cmVkJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmFsaWRhdGUgaW5wdXRcclxuICAgIHZhbGlkYXRpb24udmFsaWRhdGVDcmVkZW50aWFscyhlbWFpbCwgcGFzc3dvcmQpO1xyXG5cclxuICAgIC8vIENoZWNrIHJhdGUgbGltaXRpbmdcclxuICAgIHJhdGVMaW1pdC5jaGVja1JhdGVMaW1pdChlbWFpbCk7XHJcblxyXG4gICAgY29uc29sZS5sb2coJ/CflJAgTG9naW4gYXR0ZW1wdCBmb3I6JywgZW1haWwpO1xyXG5cclxuICAgIC8vIFZlcmlmeSBwYXNzd29yZCB1c2luZyBGaXJlYmFzZSBSRVNUIEFQSVxyXG4gICAgbGV0IGF1dGhSZXNwb25zZTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGF1dGhSZXNwb25zZSA9IGF3YWl0IHZlcmlmeVBhc3N3b3JkV2l0aEZpcmViYXNlKGVtYWlsLCBwYXNzd29yZCwgYXBpS2V5KTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgcmF0ZUxpbWl0LnJlY29yZEF0dGVtcHQoZW1haWwsIGZhbHNlKTtcclxuICAgICAgaWYgKGVycm9yLm1lc3NhZ2UgPT09ICdJTlZBTElEX1BBU1NXT1JEJyB8fCBlcnJvci5tZXNzYWdlID09PSAnRU1BSUxfTk9UX0ZPVU5EJykge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnSW52YWxpZCBlbWFpbCBvciBwYXNzd29yZCcgfSk7XHJcbiAgICAgIH1cclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IHVzZXIgcmVjb3JkIGZyb20gRmlyZWJhc2UgQXV0aFxyXG4gICAgbGV0IHVzZXJSZWNvcmQ7XHJcbiAgICB0cnkge1xyXG4gICAgICB1c2VyUmVjb3JkID0gYXdhaXQgYWRtaW4uYXV0aCgpLmdldFVzZXJCeUVtYWlsKGVtYWlsKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgcmF0ZUxpbWl0LnJlY29yZEF0dGVtcHQoZW1haWwsIGZhbHNlKTtcclxuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdhdXRoL3VzZXItbm90LWZvdW5kJykge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnSW52YWxpZCBlbWFpbCBvciBwYXNzd29yZCcgfSk7XHJcbiAgICAgIH1cclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IHVzZXIncyByb2xlIGFuZCBwZXJtaXNzaW9ucyBmcm9tIEZpcmVzdG9yZVxyXG4gICAgbGV0IHVzZXJSb2xlID0gJ3VzZXInO1xyXG4gICAgbGV0IHVzZXJQZXJtaXNzaW9uczogc3RyaW5nW10gPSBbXTtcclxuICAgIGxldCB1c2VyRGF0YTogYW55ID0ge307XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgZGIgPSBhZG1pbi5maXJlc3RvcmUoKTtcclxuICAgICAgY29uc3QgdXNlckRvYyA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3VzZXJzJykuZG9jKHVzZXJSZWNvcmQudWlkKS5nZXQoKTtcclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SNIEZpcmVzdG9yZSB1c2VyIGxvb2t1cDonLCB7IHVpZDogdXNlclJlY29yZC51aWQsIGV4aXN0czogdXNlckRvYy5leGlzdHMsIGRhdGE6IHVzZXJEb2MuZGF0YSgpIH0pO1xyXG5cclxuICAgICAgaWYgKHVzZXJEb2MuZXhpc3RzKSB7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IHVzZXJEb2MuZGF0YSgpO1xyXG4gICAgICAgIHVzZXJSb2xlID0gZGF0YT8ucm9sZSB8fCAndXNlcic7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfk4sgVXNlciBkb2N1bWVudCBmb3VuZDonLCB7IHJvbGU6IHVzZXJSb2xlLCB1c2VyRGF0YTogZGF0YSB9KTtcclxuICAgICAgICB1c2VyUGVybWlzc2lvbnMgPSBkYXRhPy5wZXJtaXNzaW9ucyB8fCBbXTtcclxuICAgICAgICB1c2VyRGF0YSA9IGRhdGEgfHwge307XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignQ291bGQgbm90IGZldGNoIHVzZXIgcm9sZSBmcm9tIEZpcmVzdG9yZTonLCBlcnJvcik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ3JlYXRlIEpXVCB0b2tlbiB3aXRoIHVzZXIgaW5mb3JtYXRpb24gYW5kIHJvbGVcclxuICAgIGNvbnN0IHRva2VuUGF5bG9hZCA9IHtcclxuICAgICAgdXNlcklkOiB1c2VyUmVjb3JkLnVpZCxcclxuICAgICAgZW1haWw6IHVzZXJSZWNvcmQuZW1haWwsXHJcbiAgICAgIGRpc3BsYXlOYW1lOiB1c2VyUmVjb3JkLmRpc3BsYXlOYW1lIHx8ICcnLFxyXG4gICAgICBwaG90b1VSTDogdXNlclJlY29yZC5waG90b1VSTCB8fCBudWxsLFxyXG4gICAgICByb2xlOiB1c2VyUm9sZSxcclxuICAgICAgcGVybWlzc2lvbnM6IHVzZXJQZXJtaXNzaW9uc1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBqd3RUb2tlbiA9IEpXVE1hbmFnZXIuY3JlYXRlVG9rZW4odG9rZW5QYXlsb2FkKTtcclxuICAgIGNvbnN0IHRva2VuRXhwaXJ5TXMgPSBKV1RNYW5hZ2VyLmdldFRva2VuRXhwaXJ5KCk7XHJcblxyXG4gICAgLy8gUHJlcGFyZSB1c2VyIGRhdGEgZm9yIHJlc3BvbnNlXHJcbiAgICBjb25zdCByZXNwb25zZVVzZXIgPSB7XHJcbiAgICAgIGlkOiB1c2VyUmVjb3JkLnVpZCxcclxuICAgICAgZW1haWw6IHVzZXJSZWNvcmQuZW1haWwsXHJcbiAgICAgIGZ1bGxfbmFtZTogdXNlclJlY29yZC5kaXNwbGF5TmFtZSB8fCAnJyxcclxuICAgICAgZGlzcGxheU5hbWU6IHVzZXJSZWNvcmQuZGlzcGxheU5hbWUgfHwgJycsXHJcbiAgICAgIHBob3RvVVJMOiB1c2VyUmVjb3JkLnBob3RvVVJMIHx8IG51bGwsXHJcbiAgICAgIHJvbGU6IHVzZXJSb2xlLFxyXG4gICAgICBwZXJtaXNzaW9uczogdXNlclBlcm1pc3Npb25zLFxyXG4gICAgICAuLi51c2VyRGF0YVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBTZXQgSldUIHRva2VuIGluIGNvb2tpZSAoYWNjZXNzaWJsZSB0byBKYXZhU2NyaXB0KVxyXG4gICAgLy8gQ3JpdGljYWw6IERPIE5PVCBzZXQgRG9tYWluIGF0dHJpYnV0ZSAtIGxldCBicm93c2VyIHVzZSBjdXJyZW50IGRvbWFpbiBvbmx5XHJcbiAgICAvLyBUaGlzIGVuc3VyZXMgZG9jdW1lbnQuY29va2llIGNhbiBhY2Nlc3MgdGhlIHRva2VuXHJcbiAgICBjb25zdCBtYXhBZ2UgPSBNYXRoLmZsb29yKHRva2VuRXhwaXJ5TXMgLyAxMDAwKTsgLy8gQ29udmVydCBtcyB0byBzZWNvbmRzXHJcbiAgICBjb25zdCBpc1Byb2R1Y3Rpb24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICByZXEuaGVhZGVycy5ob3N0Py5pbmNsdWRlcygnZmx5LmRldicpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICByZXEuaGVhZGVyc1sneC1mb3J3YXJkZWQtcHJvdG8nXSA9PT0gJ2h0dHBzJztcclxuXHJcbiAgICBjb25zdCBjb29raWVTdHJpbmcgPSBbXHJcbiAgICAgIGBhcHBfdXNlcj0ke2p3dFRva2VufWAsXHJcbiAgICAgIFwiUGF0aD0vXCIsXHJcbiAgICAgIC8vIFdoZW4gaW4gcHJvZHVjdGlvbiBPUiBpbnNpZGUgQnVpbGRlci5pbyBpZnJhbWUg4oaSIG11c3QgdXNlIE5vbmU7IFNlY3VyZVxyXG4gICAgICBpc1Byb2R1Y3Rpb24gPyBcIlNhbWVTaXRlPU5vbmVcIiA6IFwiU2FtZVNpdGU9TGF4XCIsXHJcbiAgICAgIGlzUHJvZHVjdGlvbiA/IFwiU2VjdXJlXCIgOiBcIlwiLFxyXG4gICAgICBgTWF4LUFnZT0ke21heEFnZX1gXHJcbiAgICBdLmZpbHRlcihCb29sZWFuKS5qb2luKFwiOyBcIik7XHJcblxyXG4gICAgY29uc29sZS5sb2coYPCflJAgTG9naW46IFNldHRpbmcgYXBwX3VzZXIgY29va2llIChtYXgtYWdlOiAke21heEFnZX1zLCBzZWN1cmU6ICR7aXNQcm9kdWN0aW9ufSlgKTtcclxuICAgIHJlcy5zZXRIZWFkZXIoJ1NldC1Db29raWUnLCBjb29raWVTdHJpbmcpO1xyXG5cclxuICAgIHJhdGVMaW1pdC5yZWNvcmRBdHRlbXB0KGVtYWlsLCB0cnVlKTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygn4pyFIExvZ2luIHN1Y2Nlc3NmdWwgZm9yOicsIGVtYWlsKTtcclxuXHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xyXG4gICAgICBtZXNzYWdlOiAnTG9naW4gc3VjY2Vzc2Z1bCcsXHJcbiAgICAgIHVzZXI6IHJlc3BvbnNlVXNlcixcclxuICAgICAgdG9rZW46IGp3dFRva2VuIC8vIEFsc28gcmV0dXJuIHRva2VuIGZvciBjbGllbnQtc2lkZSBzdG9yYWdlIGlmIG5lZWRlZFxyXG4gICAgfSk7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBMb2dpbiBlcnJvcjonLCBlcnJvcj8ubWVzc2FnZSB8fCBlcnJvcik7XHJcblxyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlczogeyBba2V5OiBzdHJpbmddOiB7IHN0YXR1czogbnVtYmVyOyBtZXNzYWdlOiBzdHJpbmcgfSB9ID0ge1xyXG4gICAgICAnTUlTU0lOR19DUkVERU5USUFMUyc6IHsgc3RhdHVzOiA0MDAsIG1lc3NhZ2U6ICdFbWFpbCBhbmQgcGFzc3dvcmQgYXJlIHJlcXVpcmVkJyB9LFxyXG4gICAgICAnSU5WQUxJRF9FTUFJTCc6IHsgc3RhdHVzOiA0MDAsIG1lc3NhZ2U6ICdQbGVhc2UgZW50ZXIgYSB2YWxpZCBlbWFpbCBhZGRyZXNzJyB9LFxyXG4gICAgICAnV0VBS19QQVNTV09SRCc6IHsgc3RhdHVzOiA0MDAsIG1lc3NhZ2U6ICdQYXNzd29yZCBtdXN0IGJlIGF0IGxlYXN0IDYgY2hhcmFjdGVycycgfSxcclxuICAgICAgJ1JBVEVfTElNSVRFRCc6IHsgc3RhdHVzOiA0MjksIG1lc3NhZ2U6ICdUb28gbWFueSBsb2dpbiBhdHRlbXB0cy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci4nIH0sXHJcbiAgICAgICdGSVJFQkFTRV9BUElfS0VZIGlzIG5vdCBjb25maWd1cmVkJzogeyBzdGF0dXM6IDUwMCwgbWVzc2FnZTogJ1NlcnZlciBjb25maWd1cmF0aW9uIGVycm9yIC0gRklSRUJBU0VfQVBJX0tFWSBtaXNzaW5nJyB9XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGVycm9ySW5mbyA9IGVycm9yTWVzc2FnZXNbZXJyb3I/Lm1lc3NhZ2VdO1xyXG4gICAgaWYgKGVycm9ySW5mbykge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdNYXBwZWQgZXJyb3IgcmVzcG9uc2U6JywgZXJyb3JJbmZvKTtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoZXJyb3JJbmZvLnN0YXR1cykuanNvbih7IGVycm9yOiBlcnJvckluZm8ubWVzc2FnZSB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBMb2cgZnVsbCBlcnJvciBmb3IgZGVidWdnaW5nXHJcbiAgICBjb25zb2xlLmVycm9yKCdVbm1hcHBlZCBlcnJvcjonLCBlcnJvcj8ubWVzc2FnZSwgZXJyb3I/LnRvU3RyaW5nKCkpO1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgZXJyb3I6ICdMb2dpbiBmYWlsZWQuIFBsZWFzZSB0cnkgYWdhaW4uJyxcclxuICAgICAgZGVidWc6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gZXJyb3I/Lm1lc3NhZ2UgOiB1bmRlZmluZWRcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICBhcGk6IHsgYm9keVBhcnNlcjogeyBzaXplTGltaXQ6ICcxbWInIH0gfVxyXG59O1xyXG4iXSwibmFtZXMiOlsiYWRtaW4iLCJpbml0RmlyZWJhc2VBZG1pbiIsImFwcHMiLCJsZW5ndGgiLCJzZXJ2aWNlQWNjb3VudEtleSIsInByb2Nlc3MiLCJlbnYiLCJGSVJFQkFTRV9TRVJWSUNFX0FDQ09VTlRfS0VZIiwiRXJyb3IiLCJzZXJ2aWNlQWNjb3VudCIsIkpTT04iLCJwYXJzZSIsImVyciIsImluaXRpYWxpemVBcHAiLCJjcmVkZW50aWFsIiwiY2VydCIsInZlcmlmeVBhc3N3b3JkV2l0aEZpcmViYXNlIiwiZW1haWwiLCJwYXNzd29yZCIsImFwaUtleSIsInVybCIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsInN0cmluZ2lmeSIsInJldHVyblNlY3VyZVRva2VuIiwib2siLCJlcnJvciIsImpzb24iLCJtZXNzYWdlIiwiSldUTWFuYWdlciIsIkpXVF9TRUNSRVQiLCJKV1RfRVhQSVJFU19JTiIsIk51bWJlciIsImJhc2U2NFVybEVuY29kZSIsInN0ciIsIkJ1ZmZlciIsImZyb20iLCJ0b1N0cmluZyIsInJlcGxhY2UiLCJnZW5lcmF0ZVNpZ25hdHVyZSIsImNyeXB0byIsInJlcXVpcmUiLCJjcmVhdGVIbWFjIiwidXBkYXRlIiwiZGlnZXN0IiwiY3JlYXRlVG9rZW4iLCJwYXlsb2FkIiwiaGVhZGVyIiwiYWxnIiwidHlwIiwiaWF0IiwiTWF0aCIsImZsb29yIiwiRGF0ZSIsIm5vdyIsImV4cCIsInRva2VuUGF5bG9hZCIsImhlYWRlckVuY29kZWQiLCJwYXlsb2FkRW5jb2RlZCIsInNpZ25hdHVyZSIsImdldFRva2VuRXhwaXJ5IiwidmFsaWRhdGlvbiIsInZhbGlkYXRlRW1haWwiLCJlbWFpbFJlZ2V4IiwidGVzdCIsInZhbGlkYXRlUGFzc3dvcmQiLCJCb29sZWFuIiwidmFsaWRhdGVDcmVkZW50aWFscyIsImxvZ2luQXR0ZW1wdHMiLCJNYXAiLCJNQVhfQVRURU1QVFMiLCJMT0NLT1VUX0RVUkFUSU9OIiwicmF0ZUxpbWl0IiwiY2hlY2tSYXRlTGltaXQiLCJhdHRlbXB0cyIsImdldCIsImxhc3RBdHRlbXB0IiwiY291bnQiLCJkZWxldGUiLCJyZWNvcmRBdHRlbXB0Iiwic3VjY2VzcyIsInNldCIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJzdGF0dXMiLCJGSVJFQkFTRV9BUElfS0VZIiwiY29uc29sZSIsImxvZyIsImF1dGhSZXNwb25zZSIsInVzZXJSZWNvcmQiLCJhdXRoIiwiZ2V0VXNlckJ5RW1haWwiLCJjb2RlIiwidXNlclJvbGUiLCJ1c2VyUGVybWlzc2lvbnMiLCJ1c2VyRGF0YSIsImRiIiwiZmlyZXN0b3JlIiwidXNlckRvYyIsImNvbGxlY3Rpb24iLCJkb2MiLCJ1aWQiLCJleGlzdHMiLCJkYXRhIiwicm9sZSIsInBlcm1pc3Npb25zIiwid2FybiIsInVzZXJJZCIsImRpc3BsYXlOYW1lIiwicGhvdG9VUkwiLCJqd3RUb2tlbiIsInRva2VuRXhwaXJ5TXMiLCJyZXNwb25zZVVzZXIiLCJpZCIsImZ1bGxfbmFtZSIsIm1heEFnZSIsImlzUHJvZHVjdGlvbiIsImhvc3QiLCJpbmNsdWRlcyIsImNvb2tpZVN0cmluZyIsImZpbHRlciIsImpvaW4iLCJzZXRIZWFkZXIiLCJ1c2VyIiwidG9rZW4iLCJlcnJvck1lc3NhZ2VzIiwiZXJyb3JJbmZvIiwiZGVidWciLCJ1bmRlZmluZWQiLCJjb25maWciLCJhcGkiLCJib2R5UGFyc2VyIiwic2l6ZUxpbWl0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/auth/login.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Flogin&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cauth%5Clogin.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();